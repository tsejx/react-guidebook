<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/react-guidebook/umi.css" />
    <script>
      window.routerBase = "/react-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.19
    </script>
    <title>é«˜é˜¶ç»„ä»¶</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//">React Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a aria-current="page" class="active" href="/react-guidebook//foundation">åŸºç¡€</a><a href="/react-guidebook//architect">æ¶æ„</a><a href="/react-guidebook//ecosystem">ç”Ÿæ€</a><a href="/react-guidebook//api-reference">API</a><a href="/react-guidebook//hooks">Hooks</a><a href="/react-guidebook//extensions">æ‰©å±•</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//"></a><h1>React Guidebook</h1><p>React å®Œå…¨çŸ¥è¯†ä½“ç³»</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/react-guidebook//foundation">åŸºç¡€</a></li><li><a href="/react-guidebook//architect">æ¶æ„</a></li><li><a href="/react-guidebook//ecosystem">ç”Ÿæ€</a></li><li><a href="/react-guidebook//api-reference">API</a></li><li><a href="/react-guidebook//hooks">Hooks</a></li><li><a href="/react-guidebook//extensions">æ‰©å±•</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a href="/react-guidebook//foundation/main-concepts">åŸºç¡€æ¦‚å¿µ</a><ul><li><a href="/react-guidebook//foundation/main-concepts/overview"><span>ç‰¹æ€§</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/jsx"><span>JSX</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/state"><span>State</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/props"><span>Props</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/component"><span>ç»„ä»¶åŒ–</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/lifecycle"><span>ç”Ÿå‘½å‘¨æœŸ</span></a></li><li><a href="/react-guidebook//foundation/main-concepts/react-dom"><span>ç»„ä»¶æŒ‚è½½å™¨</span></a></li></ul></li><li><a aria-current="page" class="active" href="/react-guidebook//foundation/advanced-guides">è¿›é˜¶æŒ‡å¼•</a><ul><li><a href="/react-guidebook//foundation/advanced-guides/render"><span>render</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/set-state"><span>setState</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/handling-events"><span>äº‹ä»¶æœºåˆ¶</span></a></li><li><a aria-current="page" class="active" href="/react-guidebook//foundation/advanced-guides/high-order-component"><span>é«˜é˜¶ç»„ä»¶</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/render-props"><span>Render Props</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/refs"><span>Refs</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/context"><span>Context</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/portals"><span>Portals</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/profiler"><span>Profiler</span></a></li><li><a href="/react-guidebook//foundation/advanced-guides/error-boundaries"><span>é”™è¯¯è¾¹ç•Œ</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="å±æ€§ä»£ç†" data-depth="2" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#å±æ€§ä»£ç†"><span>å±æ€§ä»£ç†</span></a></li><li title="é»˜è®¤å‚æ•°" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#é»˜è®¤å‚æ•°"><span>é»˜è®¤å‚æ•°</span></a></li><li title="é€šè¿‡ Refs ä½¿ç”¨å¼•ç”¨" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#é€šè¿‡-refs-ä½¿ç”¨å¼•ç”¨"><span>é€šè¿‡ Refs ä½¿ç”¨å¼•ç”¨</span></a></li><li title="æŠ½è±¡çŠ¶æ€" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æŠ½è±¡çŠ¶æ€"><span>æŠ½è±¡çŠ¶æ€</span></a></li><li title="åŒ…è£¹ç»„ä»¶" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#åŒ…è£¹ç»„ä»¶"><span>åŒ…è£¹ç»„ä»¶</span></a></li><li title="åå‘ç»§æ‰¿" data-depth="2" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#åå‘ç»§æ‰¿"><span>åå‘ç»§æ‰¿</span></a></li><li title="æ¸²æŸ“åŠ«æŒ" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æ¸²æŸ“åŠ«æŒ"><span>æ¸²æŸ“åŠ«æŒ</span></a></li><li title="æ“ä½œçŠ¶æ€" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æ“ä½œçŠ¶æ€"><span>æ“ä½œçŠ¶æ€</span></a></li><li title="åº”ç”¨åœºæ™¯" data-depth="2" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#åº”ç”¨åœºæ™¯"><span>åº”ç”¨åœºæ™¯</span></a></li><li title="æƒé™æ§åˆ¶" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æƒé™æ§åˆ¶"><span>æƒé™æ§åˆ¶</span></a></li><li title="æ€§èƒ½ç›‘æ§" data-depth="3" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æ€§èƒ½ç›‘æ§"><span>æ€§èƒ½ç›‘æ§</span></a></li><li title="æ³¨æ„äº‹é¡¹" data-depth="2" class=""><a href="/react-guidebook//foundation/advanced-guides/high-order-component#æ³¨æ„äº‹é¡¹"><span>æ³¨æ„äº‹é¡¹</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="é«˜é˜¶ç»„ä»¶"><a aria-hidden="true" href="#é«˜é˜¶ç»„ä»¶"><span class="icon icon-link"></span></a>é«˜é˜¶ç»„ä»¶</h1><p>é«˜é˜¶ç»„ä»¶ï¼ˆHigh-Order Componentï¼‰æ¥å— React ç»„ä»¶ä½œä¸ºè¾“å…¥ï¼Œè¾“å‡ºä¸€ä¸ªæ–°çš„ React ç»„ä»¶ã€‚</p><ul><li>é«˜é˜¶ç»„ä»¶ä¸æ˜¯ç»„ä»¶ï¼Œæ˜¯å¢å¼ºå‡½æ•°ï¼Œå¯ä»¥è¾“å…¥ä¸€ä¸ªå…ƒç»„ä»¶ï¼Œè¾“å‡ºä¸€ä¸ªæ–°çš„å¢å¼ºç»„ä»¶</li><li>é«˜é˜¶ç»„ä»¶çš„ä¸»è¦ä½œç”¨æ˜¯ä»£ç å¤ç”¨ï¼Œæ“ä½œçŠ¶æ€å’Œå‚æ•°</li></ul><p><strong>å®ç°é«˜é˜¶ç»„ä»¶çš„æ–¹æ³•ï¼š</strong></p><ul><li><a href="#%E5%B1%9E%E6%80%A7%E4%BB%A3%E7%90%86">å±æ€§ä»£ç†</a>ï¼ˆprops proxyï¼‰ã€‚é«˜é˜¶ç»„ä»¶é€šè¿‡è¢«åŒ…è£¹çš„ React ç»„ä»¶æ¥æ“ä½œ <code>props</code>ã€‚</li><li><a href="#%E5%8F%8D%E5%90%91%E7%BB%A7%E6%89%BF">åå‘ç»§æ‰¿</a>ï¼ˆinheritance inversionï¼‰ã€‚é«˜é˜¶ç»„ä»¶ç»§æ‰¿äºè¢«åŒ…è£¹çš„ React ç»„ä»¶ã€‚</li></ul><h2 id="å±æ€§ä»£ç†"><a aria-hidden="true" href="#å±æ€§ä»£ç†"><span class="icon icon-link"></span></a>å±æ€§ä»£ç†</h2><p><strong>å±æ€§ä»£ç†</strong>ï¼ˆProps Proxyï¼‰ï¼šè¾“å‡ºä¸€ä¸ªç»„ä»¶ï¼Œå®ƒåŸºäºè¢«åŒ…è£¹ç»„ä»¶è¿›è¡Œ <strong>åŠŸèƒ½å¢å¼º</strong>ã€‚</p><p>ğŸŒ° <strong>ç¤ºä¾‹ï¼š</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React from &#x27;react&#x27;;

const MyContainer = WrappedComponent =&gt;
  class extends Component {
    render() {
      return &lt;WrapperdComponent {...this.props} /&gt;;
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> React </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> Component </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">WrapperdComponent</span><span class="token tag"> </span><span class="token tag spread punctuation">{</span><span class="token tag spread punctuation">...</span><span class="token tag spread attr-value">this</span><span class="token tag spread punctuation">.</span><span class="token tag spread attr-value">props</span><span class="token tag spread punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>è¿™é‡Œçš„é«˜é˜¶ç»„ä»¶ä¸­é‡‡ç”¨äº†åŒ¿åç±»é€šè¿‡ <code>render</code> æ–¹æ³•è¿”å›ä¼ å…¥çš„ React ç»„ä»¶ï¼ˆWrappedComponentï¼‰ã€‚é€šè¿‡é«˜é˜¶ç»„ä»¶ä¼ é€’ <code>props</code>ï¼Œè¿™ç§æ–¹å¼å³ä¸º <strong>å±æ€§ä»£ç†</strong>ã€‚</p><p>è¿™æ ·ç»„ä»¶å°±å¯ä»¥ä¸€å±‚å±‚åœ°ä½œä¸ºå‚æ•°è¢«è°ƒç”¨ï¼ŒåŸå§‹ç»„ä»¶å°±å…·å¤‡äº†é«˜é˜¶ç»„ä»¶å¯¹å®ƒçš„ä¿®é¥°ã€‚å°±è¿™ä¹ˆç®€å•ï¼Œä¿æŒå•ä¸ªç»„ä»¶å°è£…æ€§çš„åŒæ—¶è¿˜ä¿ç•™äº†æ˜“ç”¨æ€§ã€‚</p><h3 id="é»˜è®¤å‚æ•°"><a aria-hidden="true" href="#é»˜è®¤å‚æ•°"><span class="icon icon-link"></span></a>é»˜è®¤å‚æ•°</h3><p><strong>é»˜è®¤å‚æ•°</strong>ï¼šå¯ä»¥ä¸ºç»„ä»¶åŒ…è£¹ä¸€å±‚é»˜è®¤å‚æ•°ã€‚</p><p>æˆ‘ä»¬å¯ä»¥è¯»å–ã€å¢åŠ ã€ç¼–è¾‘æˆ–æ˜¯ç§»é™¤ä»åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰ä¼ è¿›æ¥çš„ <code>props</code>ï¼Œä½†éœ€è¦å°å¿ƒåˆ é™¤ä¸ç¼–è¾‘é‡è¦çš„ <code>props</code>ã€‚æˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å¯¹é«˜é˜¶ç»„ä»¶çš„ <code>props</code> ä½œæ–°çš„å‘½åä»¥é˜²æ­¢æ··æ·†ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React from &#x27;react&#x27;;

const MyContainer = WrappedComponent =&gt;
  class extends React.Component {
    render() {
      const newProps = {
        name: nextName,
      };
      return &lt;WrappedComponent {...this.props} {...newProps} /&gt;;
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> newProps </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token punctuation">:</span><span class="token plain"> nextName</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">newProps</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å½“è°ƒç”¨é«˜é˜¶ç»„ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ–°çš„ props name äº†ã€‚å¯¹äºåŸç»„ä»¶æ¥è¯´ï¼Œåªè¦å¥—ç”¨è¿™ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œæˆ‘ä»¬çš„æ–°ç»„ä»¶ä¸­å°±ä¼šå¤šä¸€ä¸ª name çš„ propsã€‚</p><h3 id="é€šè¿‡-refs-ä½¿ç”¨å¼•ç”¨"><a aria-hidden="true" href="#é€šè¿‡-refs-ä½¿ç”¨å¼•ç”¨"><span class="icon icon-link"></span></a>é€šè¿‡ Refs ä½¿ç”¨å¼•ç”¨</h3><p>åœ¨é«˜é˜¶ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ¥å— Refs ä½¿ç”¨åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰çš„å¼•ç”¨ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React from &#x27;react&#x27;;

const MyContainer = WrappedComponent =&gt;
  class extends React.Component {
    proc(wrappedComponentInstance) {
      wrappedComponentInstantce.mdethod();
    }
    render() {
      const props = Object.assign({}, this.props, {
        ref: this.proc.bind(this),
      });
      return &lt;WrappedComponent {...props} /&gt;;
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">proc</span><span class="token punctuation">(</span><span class="token parameter">wrappedComponentInstance</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      wrappedComponentInstantce</span><span class="token punctuation">.</span><span class="token method function property-access">mdethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> props </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        ref</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">proc</span><span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å½“åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰è¢«æ¸²æŸ“æ—¶ï¼ŒRefs å›è°ƒå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œè¿™æ ·å°±ä¼šæ‹¿åˆ°ä¸€ä»½åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰å®ä¾‹çš„å¼•ç”¨ã€‚è¿™å°±å¯ä»¥æ–¹ä¾¿åœ°ç”¨äºè¯»å–æˆ–å¢åŠ å®ä¾‹çš„ Propsï¼Œå¹¶è°ƒç”¨å®ä¾‹çš„æ–¹æ³•ã€‚</p><h3 id="æŠ½è±¡çŠ¶æ€"><a aria-hidden="true" href="#æŠ½è±¡çŠ¶æ€"><span class="icon icon-link"></span></a>æŠ½è±¡çŠ¶æ€</h3><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰æä¾›çš„ <code>props</code> å’Œå›è°ƒå‡½æ•°æŠ½è±¡ Stateã€‚</p><p>é«˜é˜¶ç»„ä»¶å¯ä»¥å°†åŸç»„ä»¶æŠ½è±¡ä¸ºå±•ç¤ºå‹ç»„ä»¶ï¼Œåˆ†ç¦»å†…éƒ¨çŠ¶æ€ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React from &#x27;react&#x27;;

const MyContainer = WrappedCompoenent =&gt;
  class extends React.Component {
    constructor(props) {
      super(props);
      this.state = {
        name: &#x27;&#x27;,
      };
      this.onNameChange = this.onNameChange.bind(this);
    }
    onNameChange(event) {
      this.setState({
        name: event.target.value,
      });
    }
    render() {
      const newProps = {
        name: {
          value: this.state.name,
          onChange: this.onNameChange,
        },
      };
      return &lt;WrappedCompoennt {...this.props} {...newProps} /&gt;;
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedCompoenent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">super</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">onNameChange</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">onNameChange</span><span class="token punctuation">.</span><span class="token method function property-access">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">onNameChange</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token punctuation">:</span><span class="token plain"> event</span><span class="token punctuation">.</span><span class="token property-access">target</span><span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> newProps </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          value</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          onChange</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">onNameChange</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token maybe-class-name">WrappedCompoennt</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">newProps</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const nameInput = props =&gt; (&lt;input name=&#x27;name&#x27; {...props}) /&gt;)
export default MyContainer(nameInput);
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">nameInput</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">props</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token plain">input name</span><span class="token operator">=</span><span class="token string">&#x27;name&#x27;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">props</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token function maybe-class-name">MyContainer</span><span class="token punctuation">(</span><span class="token plain">nameInput</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æŠŠ <code>input</code> ç»„ä»¶ä¸­å¯¹ <code>name prop</code> çš„ <code>onChange</code> æ–¹æ³•æå–åˆ°é«˜é˜¶ç»„ä»¶ä¸­ï¼Œè¿™æ ·</p><p>å°±æœ‰æ•ˆåœ°æŠ½è±¡äº†åŒæ ·çš„çŠ¶æ€æ“ä½œã€‚</p><h3 id="åŒ…è£¹ç»„ä»¶"><a aria-hidden="true" href="#åŒ…è£¹ç»„ä»¶"><span class="icon icon-link"></span></a>åŒ…è£¹ç»„ä»¶</h3><p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨å…¶ä»–å…ƒç´ æ¥åŒ…è£¹åŸç»„ä»¶ï¼ˆWrappedComponentï¼‰ï¼Œè¿™æ—¢å¯ä»¥æ˜¯ä¸ºäº†åŠ æ ·å¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ºäº†å¸ƒå±€ã€‚</p><p>ğŸŒ° <strong>ç¤ºä¾‹ï¼šå¢åŠ ä¸€å±‚å®šä¹‰æ ·å¼</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React, { Component } from &#x27;react&#x27;

const MyContainer = (WrappedCompoennt) =&gt;
     class extends Component {
         render() {
             return {
                 &lt;div style={{display: &#x27;block&#x27;}}&gt;
                     &lt;WrappedComponent {...this.props} /&gt;
                 &lt;/div&gt;
             }
         }
     }
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">WrappedCompoennt</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">         </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                 </span><span class="token operator">&lt;</span><span class="token plain">div style</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token plain">display</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;block&#x27;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                     </span><span class="token operator">&lt;</span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                 </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">div</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">             </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">         </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="åå‘ç»§æ‰¿"><a aria-hidden="true" href="#åå‘ç»§æ‰¿"><span class="icon icon-link"></span></a>åå‘ç»§æ‰¿</h2><p><strong>åå‘ç»§æ‰¿ï¼ˆInheritance Inversionï¼‰</strong>ï¼šè¾“å‡ºä¸€ä¸ªç»„ä»¶ï¼Œç»§æ‰¿äºè¢«åŒ…è£¹ç»„ä»¶ã€‚</p><p>è¿™ç§æ–¹å¼è¿”å›çš„ React ç»„ä»¶ç»§æ‰¿äº†è¢«ä¼ å…¥çš„ç»„ä»¶ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè®¿é—®åˆ°çš„åŒºåŸŸã€æƒé™æ›´å¤šï¼Œç›¸æ¯”å±æ€§ä»£ç†æ–¹å¼ï¼Œå®ƒæ›´åƒæ‰“å…¥ç»„ç»‡å†…éƒ¨ï¼Œå¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚</p><p>ğŸŒ° <strong>ç¤ºä¾‹ï¼š</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const MyContainer = WrappedCompoenent =&gt;
  class extends WrappedComponent {
    render() {
      return super.render();
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedCompoenent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>æ­£å¦‚æ‰€è§ï¼Œé«˜é˜¶ç»„ä»¶è¿”å›çš„ç»„ä»¶ç»§æ‰¿äºåŸç»„ä»¶ <code>&lt;WrappedComponent&gt;</code>ã€‚å› ä¸ºè¢«åŠ¨åœ°ç»§æ‰¿äº† <code>&lt;WrappedComponent&gt;</code>ï¼Œæ‰€æœ‰çš„è°ƒç”¨éƒ½ä¼šåå‘ï¼Œè¿™ä¹Ÿæ˜¯è¿™ç§æ–¹æ³•çš„ç”±æ¥ã€‚</p><p>è¿™ç§æ–¹æ³•ä¸å±æ€§ä»£ç†ä¸å¤ªä¸€æ ·ã€‚å®ƒé€šè¿‡ç»§æ‰¿ <code>&lt;WrappedComponent&gt;</code> æ¥å®ç°ï¼Œæ–¹æ³•å¯ä»¥é€šè¿‡ <code>super</code> æ¥é¡ºåºè°ƒç”¨ã€‚å› ä¸ºä¾èµ–äºç»§æ‰¿çš„æœºåˆ¶ï¼ŒHOC çš„è°ƒç”¨é¡ºåºå’Œé˜Ÿåˆ—æ˜¯ä¸€æ ·çš„ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="didmount =&gt; HOC didmount =&gt; (HOCs didmount) =&gt; will unmount =&gt; HOC will unmount =&gt; (HOCs will unmount)
" data-status="copy"></button><div class="token-line"><span class="token parameter">didmount</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token constant">HOC</span><span class="token plain"> </span><span class="token parameter">didmount</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">HOCs didmount</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> will </span><span class="token parameter">unmount</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token constant">HOC</span><span class="token plain"> will </span><span class="token parameter">unmount</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token maybe-class-name">HOCs</span><span class="token plain"> will unmount</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>åœ¨åå‘ç»§æ‰¿æ–¹æ³•ä¸­ï¼Œé«˜é˜¶ç»„ä»¶å¯ä»¥ä½¿ç”¨åŸç»„ä»¶ <code>&lt;WrappedComponent&gt;</code> å¼•ç”¨ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ä½¿ç”¨åŸç»„ä»¶ <code>&lt;WrappedComponent&gt;</code> çš„ <code>state</code> ã€ <code>props</code> ã€ç”Ÿå‘½å‘¨æœŸå’Œ <code>render</code> æ–¹æ³•ã€‚ä½†å®ƒä¸èƒ½ä¿è¯å®Œæ•´çš„å­ç»„ä»¶æ ‘è¢«è§£æã€‚</p><h3 id="æ¸²æŸ“åŠ«æŒ"><a aria-hidden="true" href="#æ¸²æŸ“åŠ«æŒ"><span class="icon icon-link"></span></a>æ¸²æŸ“åŠ«æŒ</h3><p>æ¸²æŸ“åŠ«æŒæŒ‡çš„å°±æ˜¯é«˜é˜¶ç»„ä»¶å¯ä»¥æ§åˆ¶åŸç»„ä»¶ <code>&lt;WrappedComponent&gt;</code> çš„æ¸²æŸ“è¿‡ç¨‹ï¼Œå¹¶æ¸²æŸ“å„ç§å„æ ·çš„ç»“æœã€‚æˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­åœ¨ä»»ä½• React å…ƒç´ è¾“å‡ºçš„ç»“æœä¸­è¯»å–ã€å¢åŠ ã€ä¿®æ”¹ã€åˆ é™¤ <code>props</code>ï¼Œæˆ–è¯»å–æˆ–ä¿®æ”¹ React å…ƒç´ æ ‘ï¼Œæˆ–æ¡ä»¶æ˜¾ç¤ºå…ƒç´ æ ‘ï¼Œåˆæˆ–æ˜¯ç”¨æ ·å¼æ§åˆ¶åŒ…è£¹å…ƒç´ æ ‘ã€‚</p><p>æ­£å¦‚ä¹‹å‰è¯´åˆ°çš„ï¼Œåå‘ç»§æ‰¿ä¸èƒ½ä¿è¯å®Œæ•´çš„å­ç»„ä»¶æ ‘è¢«è§£æï¼Œè¿™æ„å‘³ç€å°†é™åˆ¶æ¸²æŸ“åŠ«æŒåŠŸèƒ½ã€‚ æ¸²æŸ“åŠ«æŒçš„ç»éªŒæ³•åˆ™æ˜¯æˆ‘ä»¬å¯ä»¥æ“æ§åŸç»„ä»¶ <code>&lt;WrappedComponent&gt;</code> çš„å…ƒç´ æ ‘ï¼Œå¹¶è¾“å‡ºæ­£ç¡®çš„ç»“æœã€‚ä½†å¦‚æœå…ƒç´ æ ‘ä¸­åŒ…æ‹¬äº†å‡½æ•°ç±»å‹çš„ React ç»„ä»¶ï¼Œå°±ä¸èƒ½æ“ä½œç»„ä»¶çš„å­ç»„ä»¶ã€‚</p><h4 id="æ¡ä»¶æ¸²æŸ“"><a aria-hidden="true" href="#æ¡ä»¶æ¸²æŸ“"><span class="icon icon-link"></span></a>æ¡ä»¶æ¸²æŸ“</h4><p><strong>æ¡ä»¶æ¸²æŸ“</strong>ï¼šæ ¹æ®æ¡ä»¶ï¼Œæ¸²æŸ“ä¸åŒçš„ç»„ä»¶ã€‚</p><p>ğŸŒ° <strong>ç¤ºä¾‹ï¼šæ¡ä»¶æ¸²æŸ“</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const MyContainer = WrappedComponent =&gt;
  class extends WrappedComponent {
    render() {
      if (this.props.loggedIn) {
        return super.render();
      } else {
        return null;
      }
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">loggedIn</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h4 id="ä¿®æ”¹æ¸²æŸ“"><a aria-hidden="true" href="#ä¿®æ”¹æ¸²æŸ“"><span class="icon icon-link"></span></a>ä¿®æ”¹æ¸²æŸ“</h4><p><strong>ä¿®æ”¹æ¸²æŸ“</strong>ï¼šå¯ä»¥ç›´æ¥ä¿®æ”¹è¢«åŒ…è£¹ç»„ä»¶æ¸²æŸ“å‡ºçš„ React å…ƒç´ æ ‘ã€‚</p><p>ğŸŒ° <strong>ç¤ºä¾‹ï¼šä¿®æ”¹æ¸²æŸ“</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const MyContainer = WrappedComponent =&gt;
  class extends WrappedComponent {
    render() {
      const elementsTree = super.render();
      let newProps = {};
      if (elementsTree &amp;&amp; elementsTree.type === &#x27;input&#x27;) {
        newProps = { value: &#x27;may the force be with you&#x27; };
      }
      const props = Object.assign({}, elementsTree.props, newProps);
      const newElementsTree = React.cloneElement(elementsTree, props, elementsTree.props.children);
      return newElementsTree;
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> elementsTree </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">let</span><span class="token plain"> newProps </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">elementsTree </span><span class="token operator">&amp;&amp;</span><span class="token plain"> elementsTree</span><span class="token punctuation">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&#x27;input&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        newProps </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> value</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;may the force be with you&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> props </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> elementsTree</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">,</span><span class="token plain"> newProps</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> newElementsTree </span><span class="token operator">=</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token method function property-access">cloneElement</span><span class="token punctuation">(</span><span class="token plain">elementsTree</span><span class="token punctuation">,</span><span class="token plain"> props</span><span class="token punctuation">,</span><span class="token plain"> elementsTree</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">.</span><span class="token property-access">children</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> newElementsTree</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="æ“ä½œçŠ¶æ€"><a aria-hidden="true" href="#æ“ä½œçŠ¶æ€"><span class="icon icon-link"></span></a>æ“ä½œçŠ¶æ€</h3><p>é«˜é˜¶ç»„ä»¶å¯ä»¥è¯»å–ã€ä¿®æ”¹æˆ–åˆ é™¤åŸç»„ä»¶ WrappedComponent å®ä¾‹ä¸­çš„ Stateï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œä¹Ÿå¯ä»¥å¢åŠ  Stateã€‚ä½†è¿™æ ·åšï¼Œå¯èƒ½ä¼šä½¿åŸç»„ä»¶ WrappedComponent å†…éƒ¨çŠ¶æ€å˜å¾—éš¾ä»¥è¿½è¸ªï¼Œä¸æ˜“ç»´æŠ¤ã€‚å¤§éƒ¨åˆ†çš„é«˜é˜¶ç»„ä»¶éƒ½åº”è¯¥é™åˆ¶è¯»å–æˆ–å¢åŠ  Stateï¼Œå°¤å…¶æ˜¯åè€…ï¼Œå¯ä»¥é€šè¿‡é‡æ–°å‘½å Stateï¼Œä»¥é˜²æ­¢æ··æ·†ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const MyContainer = WrappedComponent =&gt;
  class extends WrappedComponent {
    render() {
      return (
        &lt;div&gt;
          &lt;h2&gt;HOC Debugger Component&lt;/h2&gt;
          &lt;p&gt;Props&lt;/p&gt;
          &lt;pre&gt;{JSON.stringify(this.props, null, 2)}&lt;/pre&gt;
          &lt;p&gt;State&lt;/p&gt;
          &lt;pre&gt;{JSON.stringify(this.state, null, 2)}&lt;/pre&gt;
          {super.render()}
        &lt;/div&gt;
      );
    }
  };
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">MyContainer</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token operator">&lt;</span><span class="token plain">div</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">&lt;</span><span class="token plain">h2</span><span class="token operator">&gt;</span><span class="token constant">HOC</span><span class="token plain"> </span><span class="token maybe-class-name">Debugger</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">h2</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">&lt;</span><span class="token plain">p</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Props</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">p</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">&lt;</span><span class="token plain">pre</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">pre</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">&lt;</span><span class="token plain">p</span><span class="token operator">&gt;</span><span class="token maybe-class-name">State</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">p</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">&lt;</span><span class="token plain">pre</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">pre</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">{</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">div</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="åº”ç”¨åœºæ™¯"><a aria-hidden="true" href="#åº”ç”¨åœºæ™¯"><span class="icon icon-link"></span></a>åº”ç”¨åœºæ™¯</h2><h3 id="æƒé™æ§åˆ¶"><a aria-hidden="true" href="#æƒé™æ§åˆ¶"><span class="icon icon-link"></span></a>æƒé™æ§åˆ¶</h3><p><strong>æƒé™æ§åˆ¶</strong>ï¼šé€šè¿‡æŠ½è±¡é€»è¾‘ï¼Œç»Ÿä¸€å¯¹é¡µé¢è¿›è¡Œæƒé™åˆ¤æ–­ï¼ŒæŒ‰ä¸åŒçš„æ¡ä»¶è¿›è¡Œé¡µé¢æ¸²æŸ“ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const auth = (WrappedComponent) =&gt; {
    return class extends React.Component {
        constructor(props){
            super(props);
            this.state = {
                isAdmin: false
            }
        }
        async componentWillMount(){
            const currentRole = await getCurrentUserRole();
            this.setState({
                isAdmin: currentRole === &#x27;Admin&#x27;;
            })
        }
        render(){
            if(this.state.isAdmint){
                return &lt;WrapperdComponent {...this.props} /&gt;
            } else {
                return (&lt;div&gt;æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼&lt;/div&gt;)
            }
        }
    }
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">auth</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">super</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                isAdmin</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword">async</span><span class="token plain"> </span><span class="token function">componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">const</span><span class="token plain"> currentRole </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">await</span><span class="token plain"> </span><span class="token function">getCurrentUserRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token method function property-access">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                isAdmin</span><span class="token punctuation">:</span><span class="token plain"> currentRole </span><span class="token operator">===</span><span class="token plain"> </span><span class="token string">&#x27;Admin&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">state</span><span class="token punctuation">.</span><span class="token property-access">isAdmint</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token maybe-class-name">WrapperdComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token spread operator">...</span><span class="token plain">this</span><span class="token punctuation">.</span><span class="token property-access">props</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token plain">div</span><span class="token operator">&gt;</span><span class="token plain">æ‚¨æ²¡æœ‰æƒé™æŸ¥çœ‹è¯¥é¡µé¢ï¼Œè¯·è”ç³»ç®¡ç†å‘˜ï¼</span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token plain">div</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="æ€§èƒ½ç›‘æ§"><a aria-hidden="true" href="#æ€§èƒ½ç›‘æ§"><span class="icon icon-link"></span></a>æ€§èƒ½ç›‘æ§</h3><p><strong>æ€§èƒ½ç›‘æ§</strong>ï¼šåŒ…è£¹ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿›è¡Œç»Ÿä¸€åŸ‹ç‚¹ã€‚</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const performance = WrappedComponent =&gt; {
  return class extends WrappedComponent {
    constructor(props) {
      super(props);
      this.start = Date.now();
      this.end = 0;
    }
    componentDidMount() {
      super.componentDidMount &amp;&amp; super.componentDidMount();
      this.end = Date.now();
      console.log(`${WrappedComponent.name} ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º ${this.end - this.state} ms`);
    }
    render() {
      return super.render();
    }
  };
};
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token function-variable function">performance</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token parameter">WrappedComponent</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">extends</span><span class="token plain"> </span><span class="token maybe-class-name">WrappedComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">super</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">start</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">end</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token property-access">componentDidMount</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">end</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token method function property-access">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string template-punctuation string">`</span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation">WrappedComponent</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation">name</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ç»„ä»¶æ¸²æŸ“æ—¶é—´ä¸º </span><span class="token template-string interpolation interpolation-punctuation punctuation">${</span><span class="token template-string interpolation keyword">this</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation">end </span><span class="token template-string interpolation operator">-</span><span class="token template-string interpolation"> </span><span class="token template-string interpolation keyword">this</span><span class="token template-string interpolation punctuation">.</span><span class="token template-string interpolation">state</span><span class="token template-string interpolation interpolation-punctuation punctuation">}</span><span class="token template-string string"> ms</span><span class="token template-string template-punctuation string">`</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="æ³¨æ„äº‹é¡¹"><a aria-hidden="true" href="#æ³¨æ„äº‹é¡¹"><span class="icon icon-link"></span></a>æ³¨æ„äº‹é¡¹</h2><ul><li><strong>çº¯å‡½æ•°</strong>ï¼šå¢å¼ºå‡½æ•°åº”ä¸ºçº¯å‡½æ•°ï¼Œé¿å…ä¾µå…¥ä¿®æ”¹å…ƒç»„ä»¶ï¼›</li><li><strong>é¿å…ç”¨æ³•æ±¡æŸ“</strong>ï¼šç†æƒ³çŠ¶æ€ä¸‹ï¼Œåº”é€ä¼ å…ƒç»„ä»¶çš„æ— å…³å‚æ•°ä¸äº‹ä»¶ï¼Œå°½é‡ä¿è¯ç”¨æ³•ä¸å˜ï¼›</li><li><strong>å‘½åç©ºé—´</strong>ï¼šä¸º HOC å¢åŠ ç‰¹å¼‚çš„ç»„ä»¶åç§°ï¼Œè¿™æ ·èƒ½ä¾¿äºå¼€å‘è°ƒè¯•å’ŒæŸ¥æ‰¾é—®é¢˜ï¼›</li><li><strong>å¼•ç”¨ä¼ é€’</strong>ï¼šå¦‚æœéœ€è¦ä¼ é€’å…ƒç»„ä»¶çš„ refs å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>React.forwardRef</code>ï¼›</li><li><strong>é™æ€æ–¹æ³•</strong>ï¼šå…ƒç»„ä»¶ä¸Šçš„é™æ€æ–¹æ³•å¹¶æ— æ³•è¢«è‡ªåŠ¨ä¼ å‡ºï¼Œä¼šå¯¼è‡´ä¸šåŠ¡å±‚æ— æ³•è°ƒç”¨ï¼Œå› æ­¤éœ€è¦é€šè¿‡å‡½æ•°å¯¼å‡ºæˆ–è€…é™æ€æ–¹æ³•èµ‹å€¼ä¸¤ç§æ–¹æ³•è§£å†³ï¼›</li><li><strong>é‡æ–°æ¸²æŸ“</strong>ï¼šç”±äºå¢å¼ºå‡½æ•°æ¯æ¬¡è°ƒç”¨æ˜¯è¿”å›ä¸€ä¸ªæ–°ç»„ä»¶ï¼Œå› æ­¤å¦‚æœåœ¨ Render ä¸­ä½¿ç”¨å¢å¼ºå‡½æ•°ï¼Œå°±ä¼šå¯¼è‡´æ¯æ¬¡éƒ½é‡æ–°æ¸²æŸ“æ•´ä¸ª HOCï¼Œè€Œä¸”ä¹‹å‰çš„çŠ¶æ€ä¼šä¸¢å¤±ï¼›</li></ul><hr/><p><strong>å‚è€ƒèµ„æ–™ï¼š</strong></p><ul><li><a href="https://juejin.im/post/5c92f499f265da612647b754" target="_blank" rel="noopener noreferrer">ğŸ“ ä¸­é«˜çº§å‰ç«¯å¤§å‚é¢è¯•ç§˜ç±<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://juejin.im/post/5b837692f265da434015865a" target="_blank" rel="noopener noreferrer">ğŸ“ ä» 0 åˆ° 1 å®ç° React ç³»åˆ—â€”â€” HOC æ¢ç§˜<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://zhuanlan.zhihu.com/p/49485308" target="_blank" rel="noopener noreferrer">ğŸ“ æ·±å…¥ç†è§£ React é«˜é˜¶ç»„ä»¶<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/React-GuideBook/edit/master/docs/foundation/advanced-guides/high-order-component.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/1/2020, 6:20:53 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/react-guidebook/umi.js"></script>
    <script src="/react-guidebook/docs__foundation__advanced-guides__high-order-component.md.js"></script>
  </body>
</html>
