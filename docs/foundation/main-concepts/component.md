---
nav:
  title: åŸºç¡€
  order: 1
group:
  title: åŸºç¡€æ¦‚å¿µ
  order: 1
title: ç»„ä»¶åŒ–
order: 5
---

# ç»„ä»¶åŒ–

React ç»„ä»¶çš„å°è£…æ€è·¯å°±æ˜¯é¢å‘å¯¹è±¡æ€æƒ³ã€‚

è§„èŒƒæ ‡å‡†ç»„ä»¶å‡†åˆ™ï¼š

- **åŸºæœ¬çš„å°è£…æ€§**ï¼šå°½ç®¡è¯´ JavaScript æ²¡æœ‰çœŸæ­£é¢å‘å¯¹è±¡çš„æ–¹æ³•ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡å®ä¾‹åŒ–çš„æ–¹æ³•æ¥åˆ¶é€ å¯¹è±¡ã€‚
- **ç®€å•çš„ç”Ÿå‘½å‘¨æœŸå‘ˆç°**ï¼šæœ€æ˜æ˜¾çš„ä¸¤ä¸ªæ–¹æ³• `constructor` å’Œ `destroy`ï¼Œä»£è¡¨äº†ç»„ä»¶çš„æŒ‚è½½å’Œå¸è½½è¿‡ç¨‹ã€‚ä½†é™¤æ­¤ä¹‹å¤–ï¼Œå…¶ä»–è¿‡ç¨‹ï¼ˆå¦‚æ›´æ–°æ—¶çš„ç”Ÿå‘½å‘¨æœŸï¼‰å¹¶æ²¡æœ‰ä½“ç°ã€‚
- **æ˜ç¡®çš„æ•°æ®æµåŠ¨**ï¼šè¿™é‡Œçš„æ•°æ®æŒ‡çš„æ˜¯è°ƒç”¨ç»„ä»¶çš„å‚æ•°ã€‚ä¸€æ—¦ç¡®å®šå‚æ•°çš„å€¼ï¼Œå°±ä¼šè§£æä¼ è¿›æ¥çš„å‚æ•°ï¼Œæ ¹æ®å‚æ•°çš„ä¸åŒä½œå‡ºä¸åŒçš„å“åº”ï¼Œä»è€Œå¾—åˆ°æ¸²æŸ“ç»“æœã€‚

## Web Component

å››ä¸ªç»„æˆéƒ¨åˆ†ï¼š

- HTML Templates å®šä¹‰æ¨¡ç‰ˆ
- Custom Elements å®šä¹‰ç»„ä»¶å±•ç¤ºå½¢å¼
- Shadow DOM å®šä¹‰ç»„ä»¶çš„ä½œç”¨åŸŸèŒƒå›´ã€å¯ä»¥å›Šæ‹¬æ ·å¼
- HTML Imports æå‡ºæ–°çš„å¼•å…¥æ–¹å¼

## ç»„ä»¶ç±»å‹

React ç»„ä»¶åŸºæœ¬ç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šå±æ€§ï¼ˆPropsï¼‰ã€çŠ¶æ€ï¼ˆStateï¼‰å’Œç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ã€‚

**React ç»„ä»¶ç±»å‹ï¼š**

- æ— çŠ¶æ€ç»„ä»¶
- æœ‰çŠ¶æ€ç»„ä»¶
- å®¹å™¨ç»„ä»¶
- é«˜é˜¶ç»„ä»¶
- æ¸²æŸ“å›è°ƒç»„ä»¶

### æ— çŠ¶æ€ç»„ä»¶

æ— çŠ¶æ€ç»„ä»¶ï¼ˆStateless Componentï¼‰æ˜¯æœ€åŸºç¡€çš„ç»„ä»¶å½¢å¼ï¼Œç”±äºæ²¡æœ‰çŠ¶æ€çš„å½±å“æ‰€ä»¥å°±æ˜¯çº¯é™æ€å±•ç¤ºçš„ä½œç”¨ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå„ç§ UI åº“é‡Œä¹Ÿæ˜¯æœ€å¼€å§‹ä¼šå¼€å‘çš„ç»„ä»¶ç±»åˆ«ã€‚å¦‚æŒ‰é’®ã€æ ‡ç­¾ã€è¾“å…¥æ¡†ç­‰ã€‚å®ƒçš„åŸºæœ¬ç»„æˆç»“æ„å°±æ˜¯å±æ€§ï¼ˆpropsï¼‰åŠ ä¸Šä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼ˆrenderï¼‰ã€‚ç”±äºä¸æ¶‰åŠåˆ°çŠ¶æ€çš„æ›´æ–°ï¼Œæ‰€ä»¥è¿™ç§ç»„ä»¶çš„å¤ç”¨æ€§ä¹Ÿæœ€å¼ºã€‚

```jsx | pure
const PureComponent = props => <div>Hello worldï¼</div>;
```

æ— çŠ¶æ€ç»„ä»¶çš„å†™æ³•ååˆ†ç®€å•ï¼Œæ¯”èµ·ä½¿ç”¨ä¼ ç»Ÿçš„ç»„ä»¶å®šä¹‰æ–¹å¼ï¼Œæˆ‘é€šå¸¸å°±ç›´æ¥ä½¿ç”¨ ES6 è¯­æ³•ä¸­æä¾›çš„ç®­å¤´å‡½æ•°æ¥å£°æ˜è¿™ç§ç»„ä»¶å½¢å¼ã€‚å½“ç„¶ï¼Œå¦‚æœç¢°åˆ°ç¨å¾®å¤æ‚ç‚¹çš„ï¼Œå¯èƒ½è¿˜ä¼šå¸¦æœ‰ç”Ÿå‘½å‘¨æœŸçš„é’©å­å‡½æ•°ã€‚è¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ° `Class Component` çš„å†™æ³•äº†ã€‚

### æœ‰çŠ¶æ€ç»„ä»¶

åœ¨æ— çŠ¶æ€ç»„ä»¶çš„åŸºç¡€ä¸Šï¼Œå¦‚æœç»„ä»¶å†…éƒ¨åŒ…å«çŠ¶æ€ï¼ˆstateï¼‰ä¸”çŠ¶æ€éšç€äº‹ä»¶æˆ–è€…å¤–éƒ¨çš„æ¶ˆæ¯è€Œå‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œè¿™å°±æ„æˆäº†æœ‰çŠ¶æ€ç»„ä»¶ï¼ˆStateful Componentï¼‰ã€‚æœ‰çŠ¶æ€ç»„ä»¶é€šå¸¸ä¼šå¸¦æœ‰ç”Ÿå‘½å‘¨æœŸï¼ˆLifecycleï¼‰ï¼Œç”¨ä»¥åœ¨ä¸åŒçš„æ—¶åˆ»è§¦å‘çŠ¶æ€çš„æ›´æ–°ã€‚è¿™ç§ç»„ä»¶ä¹Ÿæ˜¯é€šå¸¸åœ¨å†™ä¸šåŠ¡é€»è¾‘ä¸­æœ€ç»å¸¸ä½¿ç”¨åˆ°çš„ï¼Œæ ¹æ®ä¸åŒçš„ä¸šåŠ¡åœºæ™¯ç»„ä»¶çš„çŠ¶æ€æ•°é‡ä»¥åŠç”Ÿå‘½å‘¨æœŸæœºåˆ¶ä¹Ÿä¸å°½ç›¸åŒã€‚

```jsx | pure
class StatefulComponent extends Component {

    constructor(props) {
        super(props);
        this.state = {
            //å®šä¹‰çŠ¶æ€
        }
    }

    componentWillMount() {
        //do something
    }

    componentDidMount() {
        //do something
    }

    // å…¶ä»–ç”Ÿå‘½å‘¨æœŸ

    render() {
        return (
            //render
        );
    }
}
```

### å®¹å™¨ç»„ä»¶

åœ¨å…·ä½“çš„é¡¹ç›®å®è·µä¸­ï¼Œæˆ‘ä»¬é€šå¸¸çš„å‰ç«¯æ•°æ®éƒ½æ˜¯é€šè¿‡ Ajax è¯·æ±‚è·å–çš„ï¼Œè€Œä¸”è·å–çš„åç«¯æ•°æ®ä¹Ÿéœ€è¦è¿›ä¸€æ­¥çš„åšå¤„ç†ã€‚ä¸ºäº†ä½¿ç»„ä»¶çš„èŒè´£æ›´åŠ å•ä¸€ï¼Œå¼•å…¥äº†å®¹å™¨ç»„ä»¶ï¼ˆContainer Componentï¼‰çš„æ¦‚å¿µã€‚æˆ‘ä»¬å°†æ•°æ®è·å–ä»¥åŠå¤„ç†çš„é€»è¾‘æ”¾åœ¨å®¹å™¨ç»„ä»¶ä¸­ï¼Œä½¿å¾—ç»„ä»¶çš„è€¦åˆæ€§è¿›ä¸€æ­¥åœ°é™ä½ã€‚

```jsx | pure
class UserListContainer extends React.Component {
  getInitialState() {
    return {
      users: [],
    };
  }

  componentDidMount() {
    var _this = this;
    axios.get('/path/to/user-api').then(function(response) {
      _this.setState({ users: response.data });
    });
  }

  render() {
    return <UserList users={this.state.users} />;
  }
}
```

å¦‚ä¸Šé¢è¿™ä¸ªå®¹å™¨ç»„ä»¶ï¼Œå°±æ˜¯è´Ÿè´£è·å–ç”¨æˆ·æ•°æ®ï¼Œç„¶åä»¥ `props` çš„å½¢å¼ä¼ é€’ç»™ `UserList` ç»„ä»¶æ¥æ¸²æŸ“ã€‚å®¹å™¨ç»„ä»¶ä¹Ÿä¸ä¼šåœ¨é¡µé¢ä¸­æ¸²æŸ“å‡ºå…·ä½“çš„ DOM èŠ‚ç‚¹ï¼Œå› æ­¤ï¼Œå®ƒé€šå¸¸å°±å……å½“æ•°æ®æºçš„è§’è‰²ã€‚ç›®å‰å¾ˆå¤šå¸¸ç”¨çš„æ¡†æ¶ï¼Œä¹Ÿéƒ½é‡‡ç”¨è¿™ç§ç»„ä»¶å½¢å¼ã€‚å¦‚ï¼šReact Redux çš„ `connect()`ï¼ŒRelay çš„ `createContainer()`ï¼ŒFlux Utils çš„ `Container.create()` ç­‰ã€‚

### é«˜é˜¶ç»„ä»¶

å…¶å®å¯¹äºä¸€èˆ¬çš„ä¸­å°é¡¹ç›®æ¥è¯´ï¼Œä½ åªéœ€è¦ç”¨åˆ°ä»¥ä¸Šçš„è¿™ä¸‰ç§ç»„ä»¶æ–¹å¼å°±å¯ä»¥å¾ˆå¥½åœ°æ„é€ å‡ºæ‰€éœ€çš„åº”ç”¨äº†ã€‚ä½†æ˜¯å½“é¢å¯¹å¤æ‚çš„éœ€æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¾€å¾€å¯ä»¥åˆ©ç”¨é«˜é˜¶ç»„ä»¶ï¼ˆHigher-Order Componentï¼‰ç¼–å†™å‡ºå¯é‡ç”¨æ€§æ›´å¼ºçš„ç»„ä»¶ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯é«˜é˜¶ç»„ä»¶å‘¢ï¼Ÿå…¶å®å®ƒå’Œé«˜é˜¶å‡½æ•°çš„æ¦‚å¿µç±»ä¼¼ï¼Œå°±æ˜¯ä¸€ä¸ªä¼šè¿”å›ç»„ä»¶çš„ç»„ä»¶ã€‚æˆ–è€…æ›´ç¡®åˆ‡åœ°è¯´ï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªä¼šè¿”å›ç»„ä»¶çš„å‡½æ•°ã€‚å°±åƒè¿™æ ·ï¼š

```jsx | pure
const HigherOrderComponent = WrappedComponent => {
  return class WrapperComponent extends Component {
    render() {
      //do something with WrappedComponent
    }
  };
};
```

ä½œä¸ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œå¯ä»¥åœ¨åŸæœ‰ç»„ä»¶çš„åŸºç¡€ä¸Šï¼Œå¯¹å…¶å¢åŠ æ–°çš„åŠŸèƒ½å’Œè¡Œä¸ºã€‚æˆ‘ä»¬ä¸€èˆ¬å¸Œæœ›ç¼–å†™çš„ç»„ä»¶å°½é‡çº¯å‡€æˆ–è€…è¯´å…¶ä¸­çš„ä¸šåŠ¡é€»è¾‘å°½é‡å•ä¸€ã€‚ä½†æ˜¯å¦‚æœå„ç§ç»„ä»¶é—´åˆéœ€è¦å¢åŠ æ–°åŠŸèƒ½ï¼Œå¦‚æ‰“å°æ—¥å¿—ï¼Œè·å–æ•°æ®å’Œæ ¡éªŒæ•°æ®ç­‰å’Œå±•ç¤ºæ— å…³çš„é€»è¾‘çš„æ—¶å€™ï¼Œè¿™äº›å…¬å…±çš„ä»£ç å°±ä¼šè¢«é‡å¤å†™å¾ˆå¤šéã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠ½è±¡å‡ºä¸€ä¸ªé«˜é˜¶ç»„ä»¶ï¼Œç”¨ä»¥ç»™åŸºç¡€çš„ç»„ä»¶å¢åŠ è¿™äº›åŠŸèƒ½ï¼Œç±»ä¼¼äºæ’ä»¶çš„æ•ˆæœã€‚

ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ä¾‹å­æ˜¯è¡¨å•çš„æ ¡éªŒã€‚

```jsx | pure
//æ£€éªŒè§„åˆ™ï¼Œè¡¨æ ¼ç»„ä»¶
const FormValidator = (WrappedComponent, validator, trigger) => {

   getTrigger(trigger, validator) {
      var originTrigger = this.props[trigger];
      return function(event) {
          //è§¦å‘éªŒè¯æœºåˆ¶,æ›´æ–°çŠ¶æ€
          // do something ...
          originTrigger(event);
      }
  }

  var newProps = {
    ...this.props,
    [trigger]:   this.getTrigger(trigger, validator) //è§¦å‘æ—¶æœº,é‡æ–°ç»‘å®šåŸæœ‰è§¦å‘æœºåˆ¶
  };

  return <WrappedComponent  {...newProps} />
}
```

å€¼å¾—æä¸€å¥ï¼ŒåŒæ ·æ˜¯ç»™ç»„ä»¶å¢åŠ æ–°åŠŸèƒ½çš„æ–¹æ³•ï¼Œç›¸æ¯”äºä½¿ç”¨ mixins è¿™ç§æ–¹å¼é«˜é˜¶ç»„ä»¶åˆ™æ›´åŠ ç®€æ´å’ŒèŒè´£æ›´åŠ å•ä¸€ã€‚ä½ å¦‚æœä½¿ç”¨è¿‡å¤šä¸ª mixins çš„æ—¶å€™ï¼ŒçŠ¶æ€æ±¡æŸ“å°±ååˆ†å®¹æ˜“å‘ç”Ÿï¼Œä»¥åŠä½ å¾ˆéš¾ä»ç»„ä»¶çš„å®šä¹‰ä¸Šçœ‹å‡ºéšå«åœ¨ mixins ä¸­çš„é€»è¾‘ã€‚è€Œé«˜é˜¶ç»„ä»¶çš„å¤„ç†æ–¹å¼åˆ™æ›´åŠ å®¹æ˜“ç»´æŠ¤ã€‚

å¦ä¸€æ–¹é¢ï¼ŒES7 ä¸­æ–°çš„è¯­æ³• `Decorator` ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°å’Œä¸Šé¢å†™æ³•ä¸€æ ·çš„æ•ˆæœã€‚

```jsx | pure
function LogDecorator(msg) {
  return WrappedComponent => {
    return class LogHoc extends Component {
      render() {
        // do something with this component
        console.log(msg);
        <WrappedComponent {...this.props} />;
      }
    };
  };
}

@LogDecorator('hello world')
class HelloComponent extends Component {
  render() {
    //...
  }
}
```

### æ¸²æŸ“å›è°ƒç»„ä»¶

è¿˜æœ‰ä¸€ç§ç»„ä»¶æ¨¡å¼æ˜¯åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ¸²æŸ“å›è°ƒçš„æ–¹å¼ï¼Œå°†ç»„ä»¶ä¸­çš„æ¸²æŸ“é€»è¾‘å§”æ‰˜ç»™å…¶å­ç»„ä»¶ã€‚

```jsx | pure
import { Component } from 'react';

class RenderCallbackCmp extends Component {
  constructor(props) {
    super(props);
    this.state = {
      msg: 'hello',
    };
  }

  render() {
    return this.props.children(this.state.msg);
  }
}

const ParentComponent = () => (
  <RenderCallbackCmp>
    {msg => (
      //use the msg
      <div>{msg}</div>
    )}
  </RenderCallbackCmp>
);
```

çˆ¶ç»„ä»¶è·å–äº†å†…éƒ¨çš„æ¸²æŸ“é€»è¾‘ï¼Œå› æ­¤åœ¨éœ€è¦æ§åˆ¶æ¸²æŸ“æœºåˆ¶æ—¶å¯ä»¥ä½¿ç”¨è¿™ç§ç»„ä»¶å½¢å¼ã€‚

## æ€»ç»“

ä»¥ä¸Šè¿™äº›ç»„ä»¶ç¼–å†™æ¨¡å¼åŸºæœ¬ä¸Šå¯ä»¥è¦†ç›–ç›®å‰å·¥ä½œä¸­æ‰€éœ€è¦çš„æ¨¡å¼ã€‚åœ¨å†™ä¸€äº›å¤æ‚çš„æ¡†æ¶ç»„ä»¶çš„æ—¶å€™ï¼Œä»”ç»†è®¾è®¡å’Œç ”ç©¶ç»„ä»¶é—´çš„è§£è€¦å’Œç»„åˆæ–¹å¼ï¼Œèƒ½å¤Ÿä½¿åç»­çš„é¡¹ç›®å¯ç»´æŠ¤æ€§å¤§å¤§å¢å¼ºã€‚

---

**å‚è€ƒèµ„æ–™ï¼š**

- [ğŸ“ React ä¸­çš„äº”ç§ç»„ä»¶å½¢å¼](https://juejin.im/post/596d65d66fb9a06bae1e19e2)
